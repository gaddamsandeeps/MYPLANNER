<!DOCTYPE html>
<html>
    <head>
        <title>Reports</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="lib/bootstrap.css" rel="stylesheet">        
        <link href='lib/fullcalendar.css' rel='stylesheet'>
        <link href='css/report/report.css' rel='stylesheet'>
		
		<!-- jquery datatables-->
		<link href='css/datatables/jquery.dataTables.css' rel='stylesheet'>

		<script src='lib/jquery-1.11.1.min.js'></script>
		<script src='lib/jquery.dataTables.min.js'></script>

        <script src="js/report/highcharts.js"></script>
        <script src="js/report/exporting.js"></script>
        <script src='js/common/util.js'></script>    
        <script src='js/common/dateformat.js'></script>    
        <script src="js/report/report.js"></script>
        <script type="text/javascript">
			$(function() {
				$('#myTab li a').click(function() {
					var getname = $(this).attr('name');
					$('.tab-pane').hide();
					$('.active').removeClass('active');
					$(this).parent('li').addClass('active');
					$('#' + getname).parent('.tab-pane').show();
				})
			});

			$(document).ready(
					function() {
						$('#generateExcel').click(
								function() {

									var userId = getUrlVars()["id"];
									var url;
									var titlePrefix,titleSuffix = ' logs from '+$("#reportStartTime").val()+' to '+$("#reportEndTime").val();
									var cols = 9;
									if (userId) {
										cols--;
										<% if (typeof selectedUser !="undefined" ) { %>
												titlePrefix = '<%= selectedUser.firstname +" "+ selectedUser.lastname %>';
										<% } %>
										// user report log ajax cal
										url = "/getDetailedUserReportLogs?startdate="
												+ $("#reportStartTime").val() + "&enddate="
												+ $("#reportEndTime").val() + "&userid="
												+ userId;
									} else {
										<% if (typeof user.teamName !="undefined" ) { %>
												titlePrefix = '<%= user.teamName+" " %>';
										<% } %>
										titlePrefix += 'Team';
										// team report log ajax cal
										url = "/getDetailedReportLogs?startdate="
												+ $("#reportStartTime").val() + "&enddate="
												+ $("#reportEndTime").val();
									}
									var data = $.getValues(url);
									if (data == '')
										return;

									JSONToCSVConvertor(data, titlePrefix+titleSuffix, true,cols);
								});
					});
        </script>

    </head>
    <body>
        <% var pageName = 'report' %>
        <% include header.html %>
		<% if (typeof selectedUser !="undefined" && typeof user.teamName !="undefined") { %>
				<b><%= selectedUser.firstname +" "+ selectedUser.lastname %></b>
		<% } %>

		<div class="reportGenerator">
            <ul id="myTab" class="nav nav-tabs">
                <li class="active wholereport">
                    <a href="javascript:void(0)" name="userReport">
                        Users Report
                    </a>
                </li>
                <li class="wholereport">
                    <a href="javascript:void(0)" name="ProjectReport">
                        Projects Report
                    </a>
                </li>
				<li class="wholereport">
                    <a href="javascript:void(0)" name="excelReport">
                        Excel Report
                    </a>
                </li>
                <li class="active singlereport">
                    <a href="javascript:void(0)" name="SingleUserReport">
                        Projects Report
                    </a>
                </li>
                <li class="singlereport">
                    <a href="javascript:void(0)" name="workingHoursReport">
                        Logs Report
                    </a>
                </li>
				<li class="singlereport">
                    <a href="javascript:void(0)" name="singleExcelReport">
                        Excel Report
                    </a>					
                </li>
				<li>
            </ul>
            <div id="myTabContent" class="tab-content">
                <div class="datePickers">
                    <div class="col-md-4">
                        Start date :
                        <input type="date" id="reportStartTime"  name="reportStartTime" class="form-control" placeholder="Start Time" required>
                    </div>
                    <div class="col-md-4">
                        End Date :
                        <input type="date" id="reportEndTime" name="reportEndTime" class="form-control" >
                    </div>
                    <div class="col-md-4">
                        <button style="margin-top:25px;margin-right:200px;" id="checkReport" class="fc-today-button pull-right fc-button fc-state-default fc-corner-left fc-corner-right fc-state-disabled" onclick=" DifferenceCounter()">Report</button>
                    </div>
                </div>
                <div class="tab-pane active wholereport">
                    <div id="userReport" class="reports"></div>
                </div>
                <div class="tab-pane wholereport" id="ios">
                    <div id="ProjectReport" class="reports"></div>
                    <div id="UserProjectReport" class="reports"></div>
                </div>
                <div class="tab-pane active singlereport">
                    <div id="SingleUserReport" class="reports"></div>
                </div>
                <div class="tab-pane singlereport">
                    <div id="workingHoursReport" class="reports"></div>
                </div>
				<div class="tab-pane wholereport">
					<img alt="Generate Excel" src="images/excel_download.png" id="generateExcel"  style="margin-left: 113px;margin-top: -15px;" >
                    <div id="excelReport" class="reports"></div>
					<table id="excelReportTable" class="display" cellspacing="0" width="100%">
						<thead>
							<tr>
								<th>ID</th>	
								<th>PROJECT</th>
								<th>DESCRIPTION</th>
								<th>USER</th>
								<th>START</th>
								<th>END</th>
								<th>LOGGED</th>
								<th>CREATED</th>
								<th>EDITED</th>
							</tr>
						</thead>
					</table>
                </div>
				<div class="tab-pane singlereport">
					<img alt="Generate Excel" src="images/excel_download.png" id="generateExcel"  style="margin-left: 113px;margin-top: -15px;" >
                    <div id="singleExcelReport" class="reports"></div>
					<table id="singleExcelReportTable" class="display" cellspacing="0" width="100%">
						<thead>
							<tr>
								<th>ID</th>	
								<th>PROJECT</th>	
								<th>DESCRIPTION</th>
								<th>START</th>
								<th>END</th>
								<th>LOGGED</th>
								<th>CREATED</th>
								<th>EDITED</th>
							</tr>
						</thead>
					</table>
                </div>
            </div>
        </div>
        <% include footer.html %>
    </body>
</html>
